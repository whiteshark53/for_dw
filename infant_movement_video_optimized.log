2025-07-01 06:36:34,817 - INFO - TensorFlow version: 2.13.1
2025-07-01 06:36:35,090 - INFO - GPU не обнаружены, будет использоваться CPU
2025-07-01 06:36:35,092 - INFO - ==================================================
2025-07-01 06:36:35,093 - INFO - ЗАПУСК ОПТИМИЗИРОВАННОЙ ПРОГРАММЫ
2025-07-01 06:36:35,093 - INFO - ==================================================
2025-07-01 06:36:35,094 - INFO - Обработка: data_100_50_50.npz и target_100_50_50.npz
2025-07-01 06:36:37,778 - INFO - Загружен массив 'arr_0': форма=(767, 100, 50, 50, 3), тип=uint8
2025-07-01 06:36:37,778 - INFO - Исходная форма видео: (767, 100, 50, 50, 3)
2025-07-01 06:36:38,179 - INFO - Разрешение уменьшено в 0.5 раза: (767, 100, 25, 25, 3)
2025-07-01 06:36:38,180 - INFO - Обрезано до 20 кадров
2025-07-01 06:36:38,213 - INFO - Предобработка завершена за 0.43 сек
2025-07-01 06:36:38,215 - INFO - Форма после обработки: (767, 20, 25, 25, 3)
2025-07-01 06:36:38,217 - INFO - Загружен массив 'arr_0': форма=(767,), тип=int64
2025-07-01 06:36:38,218 - INFO - Успешно обработано: data_100_50_50.npz -> 767 samples
2025-07-01 06:36:38,328 - INFO - Обработка: data_40_50_50.npz и target_40_50_50.npz
2025-07-01 06:36:41,140 - INFO - Загружен массив 'arr_0': форма=(1946, 40, 50, 50, 3), тип=uint8
2025-07-01 06:36:41,141 - INFO - Исходная форма видео: (1946, 40, 50, 50, 3)
2025-07-01 06:36:41,620 - INFO - Разрешение уменьшено в 0.5 раза: (1946, 40, 25, 25, 3)
2025-07-01 06:36:41,622 - INFO - Обрезано до 20 кадров
2025-07-01 06:36:41,707 - INFO - Предобработка завершена за 0.57 сек
2025-07-01 06:36:41,712 - INFO - Форма после обработки: (1946, 20, 25, 25, 3)
2025-07-01 06:36:41,714 - INFO - Загружен массив 'arr_0': форма=(1946,), тип=int64
2025-07-01 06:36:41,714 - INFO - Успешно обработано: data_40_50_50.npz -> 1946 samples
2025-07-01 06:36:41,831 - INFO - Обработка: data_60_50_50.npz и target_60_50_50.npz
2025-07-01 06:36:44,652 - INFO - Загружен массив 'arr_0': форма=(1288, 60, 50, 50, 3), тип=uint8
2025-07-01 06:36:44,653 - INFO - Исходная форма видео: (1288, 60, 50, 50, 3)
2025-07-01 06:36:45,050 - INFO - Разрешение уменьшено в 0.5 раза: (1288, 60, 25, 25, 3)
2025-07-01 06:36:45,051 - INFO - Обрезано до 20 кадров
2025-07-01 06:36:45,107 - INFO - Предобработка завершена за 0.45 сек
2025-07-01 06:36:45,109 - INFO - Форма после обработки: (1288, 20, 25, 25, 3)
2025-07-01 06:36:45,111 - INFO - Загружен массив 'arr_0': форма=(1288,), тип=int64
2025-07-01 06:36:45,112 - INFO - Успешно обработано: data_60_50_50.npz -> 1288 samples
2025-07-01 06:36:45,402 - INFO - Итоговая форма данных: (4001, 20, 25, 25, 3)
2025-07-01 06:36:45,409 - INFO - Распределение классов: 0=491, 1=319
2025-07-01 06:36:45,410 - INFO - Разделение данных на train/test...
2025-07-01 06:36:45,607 - INFO - Создание модели для input_shape: (20, 25, 25, 3)
2025-07-01 06:36:45,706 - INFO - ==================================================
2025-07-01 06:36:45,707 - INFO - НАЧАЛО ОБУЧЕНИЯ
2025-07-01 06:36:45,708 - INFO - ==================================================
2025-07-01 06:36:45,709 - INFO - Эпоха 1/10
2025-07-01 06:37:32,664 - INFO - Эпоха 2/10
2025-07-01 06:38:18,485 - INFO - Эпоха 3/10
2025-07-01 06:39:04,543 - INFO - Эпоха 4/10
2025-07-01 06:39:51,566 - INFO - Эпоха 5/10
2025-07-01 06:40:39,350 - INFO - Эпоха 6/10
2025-07-01 06:41:25,948 - INFO - Эпоха 7/10
2025-07-01 06:42:11,857 - INFO - Эпоха 8/10
2025-07-01 06:42:57,587 - INFO - Эпоха 9/10
2025-07-01 06:43:44,044 - INFO - Эпоха 10/10
2025-07-01 06:44:30,420 - INFO - ==================================================
2025-07-01 06:44:30,421 - INFO - ОЦЕНКА МОДЕЛИ
2025-07-01 06:44:30,422 - INFO - ==================================================
2025-07-01 06:45:34,386 - ERROR - Ошибка оценки:
Traceback (most recent call last):
  File "/tmp/ipykernel_12652/3225222556.py", line 318, in main
    roc_auc = roc_auc_score(y_test, y_pred)
  File "/home/whiteshark53/.local/lib/python3.8/site-packages/sklearn/utils/_param_validation.py", line 214, in wrapper
    return func(*args, **kwargs)
  File "/home/whiteshark53/.local/lib/python3.8/site-packages/sklearn/metrics/_ranking.py", line 620, in roc_auc_score
    raise ValueError("multi_class must be in ('ovo', 'ovr')")
ValueError: multi_class must be in ('ovo', 'ovr')
2025-07-01 06:45:34,397 - INFO - ==================================================
2025-07-01 06:45:34,398 - INFO - ПРОГРАММА ЗАВЕРШЕНА
2025-07-01 06:45:34,398 - INFO - ==================================================
2025-07-01 06:55:03,451 - INFO - ==================================================
2025-07-01 06:55:03,452 - INFO - ЗАПУСК КЛАССИФИКАЦИИ ДВИЖЕНИЙ МЛАДЕНЦЕВ
2025-07-01 06:55:03,452 - INFO - ==================================================
2025-07-01 06:55:03,453 - INFO - Загрузка ./data/data_40_50_50.npz и ./data/target_40_50_50.npz
2025-07-01 06:55:06,250 - INFO - Обработано 100/1946 видео
2025-07-01 06:55:06,297 - INFO - Обработано 200/1946 видео
2025-07-01 06:55:06,348 - INFO - Обработано 300/1946 видео
2025-07-01 06:55:06,415 - INFO - Обработано 400/1946 видео
2025-07-01 06:55:06,475 - INFO - Обработано 500/1946 видео
2025-07-01 06:55:06,535 - INFO - Обработано 600/1946 видео
2025-07-01 06:55:06,596 - INFO - Обработано 700/1946 видео
2025-07-01 06:55:06,665 - INFO - Обработано 800/1946 видео
2025-07-01 06:55:06,738 - INFO - Обработано 900/1946 видео
2025-07-01 06:55:06,808 - INFO - Обработано 1000/1946 видео
2025-07-01 06:55:06,878 - INFO - Обработано 1100/1946 видео
2025-07-01 06:55:06,951 - INFO - Обработано 1200/1946 видео
2025-07-01 06:55:07,019 - INFO - Обработано 1300/1946 видео
2025-07-01 06:55:07,092 - INFO - Обработано 1400/1946 видео
2025-07-01 06:55:07,132 - INFO - Обработано 1500/1946 видео
2025-07-01 06:55:07,172 - INFO - Обработано 1600/1946 видео
2025-07-01 06:55:07,213 - INFO - Обработано 1700/1946 видео
2025-07-01 06:55:07,254 - INFO - Обработано 1800/1946 видео
2025-07-01 06:55:07,296 - INFO - Обработано 1900/1946 видео
2025-07-01 06:55:07,490 - INFO - Обработано: data_40_50_50.npz - 1946 samples
2025-07-01 06:55:07,639 - INFO - Загрузка ./data/data_60_50_50.npz и ./data/target_60_50_50.npz
2025-07-01 06:55:10,229 - INFO - Обработано 100/1288 видео
2025-07-01 06:55:10,265 - INFO - Обработано 200/1288 видео
2025-07-01 06:55:10,304 - INFO - Обработано 300/1288 видео
2025-07-01 06:55:10,336 - INFO - Обработано 400/1288 видео
2025-07-01 06:55:10,366 - INFO - Обработано 500/1288 видео
2025-07-01 06:55:10,398 - INFO - Обработано 600/1288 видео
2025-07-01 06:55:10,428 - INFO - Обработано 700/1288 видео
2025-07-01 06:55:10,459 - INFO - Обработано 800/1288 видео
2025-07-01 06:55:10,490 - INFO - Обработано 900/1288 видео
2025-07-01 06:55:10,531 - INFO - Обработано 1000/1288 видео
2025-07-01 06:55:10,563 - INFO - Обработано 1100/1288 видео
2025-07-01 06:55:10,597 - INFO - Обработано 1200/1288 видео
2025-07-01 06:55:10,727 - INFO - Обработано: data_60_50_50.npz - 1288 samples
2025-07-01 06:55:10,839 - INFO - Загрузка ./data/data_100_50_50.npz и ./data/target_100_50_50.npz
2025-07-01 06:55:13,336 - INFO - Обработано 100/767 видео
2025-07-01 06:55:13,370 - INFO - Обработано 200/767 видео
2025-07-01 06:55:13,403 - INFO - Обработано 300/767 видео
2025-07-01 06:55:13,439 - INFO - Обработано 400/767 видео
2025-07-01 06:55:13,469 - INFO - Обработано 500/767 видео
2025-07-01 06:55:13,498 - INFO - Обработано 600/767 видео
2025-07-01 06:55:13,528 - INFO - Обработано 700/767 видео
2025-07-01 06:55:13,576 - INFO - Обработано: data_100_50_50.npz - 767 samples
2025-07-01 06:55:13,879 - INFO - Общая форма данных: (4001, 20, 32, 32, 3)
2025-07-01 06:55:13,880 - INFO - Распределение классов: [491 319 426 561 476 503 517 708]
2025-07-01 06:55:14,419 - INFO - Model: "sequential_1"
2025-07-01 06:55:14,420 - INFO - _________________________________________________________________
2025-07-01 06:55:14,420 - INFO -  Layer (type)                Output Shape              Param #   
2025-07-01 06:55:14,421 - INFO - =================================================================
2025-07-01 06:55:14,422 - INFO -  conv3d_2 (Conv3D)           (None, 20, 32, 32, 8)     656       
2025-07-01 06:55:14,423 - INFO -                                                                  
2025-07-01 06:55:14,423 - INFO -  batch_normalization_2 (Bat  (None, 20, 32, 32, 8)     32        
2025-07-01 06:55:14,424 - INFO -  chNormalization)                                                
2025-07-01 06:55:14,425 - INFO -                                                                  
2025-07-01 06:55:14,426 - INFO -  max_pooling3d_2 (MaxPoolin  (None, 20, 16, 16, 8)     0         
2025-07-01 06:55:14,427 - INFO -  g3D)                                                            
2025-07-01 06:55:14,428 - INFO -                                                                  
2025-07-01 06:55:14,429 - INFO -  dropout_3 (Dropout)         (None, 20, 16, 16, 8)     0         
2025-07-01 06:55:14,429 - INFO -                                                                  
2025-07-01 06:55:14,430 - INFO -  conv3d_3 (Conv3D)           (None, 20, 16, 16, 16)    3472      
2025-07-01 06:55:14,431 - INFO -                                                                  
2025-07-01 06:55:14,433 - INFO -  batch_normalization_3 (Bat  (None, 20, 16, 16, 16)    64        
2025-07-01 06:55:14,434 - INFO -  chNormalization)                                                
2025-07-01 06:55:14,434 - INFO -                                                                  
2025-07-01 06:55:14,435 - INFO -  max_pooling3d_3 (MaxPoolin  (None, 10, 8, 8, 16)      0         
2025-07-01 06:55:14,436 - INFO -  g3D)                                                            
2025-07-01 06:55:14,437 - INFO -                                                                  
2025-07-01 06:55:14,438 - INFO -  dropout_4 (Dropout)         (None, 10, 8, 8, 16)      0         
2025-07-01 06:55:14,439 - INFO -                                                                  
2025-07-01 06:55:14,440 - INFO -  global_average_pooling3d_1  (None, 16)                0         
2025-07-01 06:55:14,441 - INFO -   (GlobalAveragePooling3D)                                       
2025-07-01 06:55:14,442 - INFO -                                                                  
2025-07-01 06:55:14,443 - INFO -  dense_2 (Dense)             (None, 32)                544       
2025-07-01 06:55:14,444 - INFO -                                                                  
2025-07-01 06:55:14,445 - INFO -  dropout_5 (Dropout)         (None, 32)                0         
2025-07-01 06:55:14,446 - INFO -                                                                  
2025-07-01 06:55:14,448 - INFO -  dense_3 (Dense)             (None, 8)                 264       
2025-07-01 06:55:14,448 - INFO -                                                                  
2025-07-01 06:55:14,450 - INFO - =================================================================
2025-07-01 06:55:14,451 - INFO - Total params: 5032 (19.66 KB)
2025-07-01 06:55:14,452 - INFO - Trainable params: 4984 (19.47 KB)
2025-07-01 06:55:14,453 - INFO - Non-trainable params: 48 (192.00 Byte)
2025-07-01 06:55:14,453 - INFO - _________________________________________________________________
2025-07-01 06:55:14,454 - INFO - Начало обучения...
2025-07-01 07:14:03,322 - INFO - Модель сохранена как 'infant_movement_classifier.h5'
2025-07-01 07:14:03,323 - INFO - Оценка модели...
2025-07-01 07:14:03,431 - INFO - Обработано 4/801 валидационных образцов
2025-07-01 07:14:04,010 - INFO - Обработано 44/801 валидационных образцов
2025-07-01 07:14:04,587 - INFO - Обработано 84/801 валидационных образцов
2025-07-01 07:14:05,170 - INFO - Обработано 124/801 валидационных образцов
2025-07-01 07:14:05,745 - INFO - Обработано 164/801 валидационных образцов
2025-07-01 07:14:06,329 - INFO - Обработано 204/801 валидационных образцов
2025-07-01 07:14:06,895 - INFO - Обработано 244/801 валидационных образцов
2025-07-01 07:14:07,471 - INFO - Обработано 284/801 валидационных образцов
2025-07-01 07:14:08,043 - INFO - Обработано 324/801 валидационных образцов
2025-07-01 07:14:08,611 - INFO - Обработано 364/801 валидационных образцов
2025-07-01 07:14:09,183 - INFO - Обработано 404/801 валидационных образцов
2025-07-01 07:14:09,755 - INFO - Обработано 444/801 валидационных образцов
2025-07-01 07:14:10,331 - INFO - Обработано 484/801 валидационных образцов
2025-07-01 07:14:10,898 - INFO - Обработано 524/801 валидационных образцов
2025-07-01 07:14:11,474 - INFO - Обработано 564/801 валидационных образцов
2025-07-01 07:14:12,040 - INFO - Обработано 604/801 валидационных образцов
2025-07-01 07:14:12,615 - INFO - Обработано 644/801 валидационных образцов
2025-07-01 07:14:13,193 - INFO - Обработано 684/801 валидационных образцов
2025-07-01 07:14:13,773 - INFO - Обработано 724/801 валидационных образцов
2025-07-01 07:14:14,341 - INFO - Обработано 764/801 валидационных образцов
2025-07-01 07:14:14,894 - INFO - Обработано 804/801 валидационных образцов
2025-07-01 07:14:14,895 - INFO - 
Classification Report:
2025-07-01 07:14:14,901 - INFO -                           precision    recall  f1-score   support

        Abnormal fidgety       0.97      0.85      0.90        98
                 Chaotic       1.00      1.00      1.00        64
      Cramp synchronized       1.00      0.87      0.93        85
         Poor repertoire       1.00      1.00      1.00       112
          Normal fidgety       0.81      1.00      0.89        95
         Normal writhing       1.00      1.00      1.00       101
            No movements       1.00      1.00      1.00       104
Random (Other movements)       1.00      1.00      1.00       142

                accuracy                           0.97       801
               macro avg       0.97      0.96      0.97       801
            weighted avg       0.97      0.97      0.97       801

2025-07-01 07:14:14,903 - INFO - 
Confusion Matrix:
2025-07-01 07:14:14,903 - INFO - [[ 83   0   0   0  15   0   0   0]
 [  0  64   0   0   0   0   0   0]
 [  3   0  74   0   8   0   0   0]
 [  0   0   0 112   0   0   0   0]
 [  0   0   0   0  95   0   0   0]
 [  0   0   0   0   0 101   0   0]
 [  0   0   0   0   0   0 104   0]
 [  0   0   0   0   0   0   0 142]]
2025-07-01 07:14:15,357 - INFO - Общее время выполнения: 19.20 минут
2025-07-01 07:14:15,358 - INFO - ==================================================
2025-07-01 07:14:15,359 - INFO - ПРОГРАММА ЗАВЕРШЕНА
2025-07-01 07:14:15,360 - INFO - ==================================================
